<?php require_once 'config.php'; ?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Analysis - Lab 22</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #164e63 100%);
            color: #e2e8f0;
            min-height: 100vh;
            line-height: 1.7;
        }
        .header {
            background: rgba(15, 23, 42, 0.9);
            border-bottom: 1px solid rgba(6, 182, 212, 0.3);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .logo { font-size: 1.5rem; font-weight: bold; color: #22d3ee; }
        .nav-links { display: flex; gap: 1rem; }
        .nav-links a {
            padding: 0.5rem 1rem;
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            color: #22d3ee;
            text-decoration: none;
            border-radius: 6px;
        }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        h1 { color: #22d3ee; font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { color: #64748b; margin-bottom: 2rem; }
        .card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .card h2 { color: #22d3ee; margin-bottom: 1rem; }
        .card h3 { color: #f59e0b; margin: 1.5rem 0 1rem; }
        .card p { color: #94a3b8; margin-bottom: 1rem; }
        .card ul, .card ol { color: #94a3b8; margin-left: 1.5rem; margin-bottom: 1rem; }
        .card li { margin-bottom: 0.5rem; }
        .severity-box {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .severity-medium { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .impact-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        .impact-table th, .impact-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(6, 182, 212, 0.2);
        }
        .impact-table th { color: #22d3ee; background: rgba(6, 182, 212, 0.1); }
        .code-block {
            background: #0d1117;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
        .code-block pre { color: #e2e8f0; font-family: monospace; font-size: 0.85rem; }
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin: 0.25rem;
        }
        .btn-primary { background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; }
        .btn-secondary { background: rgba(6, 182, 212, 0.1); border: 1px solid rgba(6, 182, 212, 0.3); color: #22d3ee; }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">üöó RideKea</div>
        <nav class="nav-links">
            <a href="docs.php">‚Üê Docs</a>
            <a href="lab-description.php">üìñ Guide</a>
            <a href="login.php">üîë Login</a>
        </nav>
    </header>

    <div class="container">
        <h1>üéØ Vulnerability Analysis</h1>
        <p class="subtitle">Comprehensive analysis of IDOR in ride-sharing booking systems</p>

        <div class="card">
            <h2>üìã Vulnerability Summary</h2>
            <p><strong>Vulnerability Type:</strong> Insecure Direct Object Reference (IDOR)</p>
            <p><strong>Affected Component:</strong> Booking and Bids API Endpoints</p>
            <p><strong>Attack Vector:</strong> Authenticated Remote</p>
            <div class="severity-box severity-medium">
                <span>‚ö†Ô∏è</span>
                <span><strong>Severity:</strong> Medium (CVSS 5.3)</span>
            </div>
        </div>

        <div class="card">
            <h2>üîç What is IDOR?</h2>
            <p>Insecure Direct Object Reference (IDOR) is a type of access control vulnerability that occurs when an application exposes internal implementation objects to users. In this case, the application uses predictable booking IDs in API requests without verifying that the requesting user has permission to access the resource.</p>
            
            <h3>The Core Problem</h3>
            <p>The API endpoints accept a <code>booking_id</code> parameter and return data without checking:</p>
            <ul>
                <li>Whether the current user owns the booking</li>
                <li>Whether the current user has any relationship to the booking</li>
                <li>Any authorization rules beyond authentication</li>
            </ul>
        </div>

        <div class="card">
            <h2>üé≠ Attack Scenario</h2>
            <ol>
                <li><strong>Reconnaissance:</strong> Attacker creates an account and observes their own booking ID format</li>
                <li><strong>Enumeration:</strong> Attacker discovers or guesses other booking IDs</li>
                <li><strong>Exploitation:</strong> Attacker accesses victim's booking details via API</li>
                <li><strong>Data Extraction:</strong> Attacker extracts sensitive personal information</li>
            </ol>

            <h3>Data Exposed</h3>
            <table class="impact-table">
                <thead>
                    <tr>
                        <th>Endpoint</th>
                        <th>Sensitive Data</th>
                        <th>Privacy Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>/api/bookings.php</code></td>
                        <td>Name, Phone, Email, Full Address, GPS Coords</td>
                        <td>High - PII + Location</td>
                    </tr>
                    <tr>
                        <td><code>/api/bids.php</code></td>
                        <td>Driver Names, Phone Numbers, Vehicle Details</td>
                        <td>High - Third Party PII</td>
                    </tr>
                    <tr>
                        <td><code>/api/bids_config.php</code></td>
                        <td>Pricing Config, Bid Thresholds</td>
                        <td>Medium - Business Logic</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card">
            <h2>‚ö†Ô∏è Real-World Impact</h2>
            <p>This vulnerability could enable:</p>
            <ul>
                <li><strong>Stalking:</strong> Attacker learns victim's home address and travel patterns</li>
                <li><strong>Social Engineering:</strong> Attacker impersonates driver using exposed details</li>
                <li><strong>Physical Security:</strong> Knowing when someone leaves their home</li>
                <li><strong>Identity Theft:</strong> Combination of name, phone, email, address</li>
                <li><strong>Driver Harassment:</strong> Exposed driver contact information</li>
            </ul>
        </div>

        <div class="card">
            <h2>üìä CVSS Scoring</h2>
            <div class="code-block">
<pre>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N

Attack Vector (AV): Network - Exploitable over the internet
Attack Complexity (AC): Low - No special conditions needed
Privileges Required (PR): Low - Requires authentication
User Interaction (UI): None - No victim action needed
Scope (S): Unchanged - Impact limited to vulnerable system
Confidentiality (C): Low - Limited data exposure
Integrity (I): None - No data modification
Availability (A): None - No service disruption

Base Score: 4.3 (Medium)
Environmental Score: 5.3 (Medium) - Due to sensitive data nature</pre>
            </div>
        </div>

        <div style="text-align: center; margin-top: 2rem;">
            <a href="docs-technical.php" class="btn btn-primary">Next: Technical Deep Dive ‚Üí</a>
            <a href="docs.php" class="btn btn-secondary">‚Üê Back to Docs</a>
        </div>
    </div>
</body>
</html>
